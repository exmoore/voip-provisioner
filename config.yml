# VOIP Provisioning Server Configuration
# ========================================

server:
  # Server binding
  host: "0.0.0.0"
  port: 8080
  
  # Logging level: DEBUG, INFO, WARNING, ERROR
  log_level: "INFO"
  
  # JSON logging for Loki/Promtail integration
  json_logs: true

paths:
  # Inventory files location
  inventory_dir: "inventory"
  
  # Jinja2 templates location
  templates_dir: "templates"
  
  # Secrets file (optional, for password storage)
  secrets_file: "inventory/secrets.yml"

# Global PBX settings (can be overridden per-phone in inventory)
pbx:
  server: "pbx.example.com"
  port: 5060
  transport: "UDP"  # UDP, TCP, or TLS
  
# Time settings
time:
  ntp_server: "pool.ntp.org"
  timezone: "America/New_York"

# Vendor MAC OUI prefixes for auto-detection
# Format: list of 3-byte hex prefixes (no separators)
vendor_oui:
  yealink:
    - "001565"
    - "805E0C"
    - "805EC0"
    - "245EBE"
  fanvil:
    - "0C383E"
    - "7C2F80"

# Asterisk AMI integration (optional)
asterisk:
  # Enable Asterisk integration
  enabled: false

  # Asterisk Manager Interface (AMI) connection
  host: "localhost"
  port: 5038
  username: "admin"
  password: "secret"  # Consider using environment variable: ${ASTERISK_AMI_PASSWORD}
  timeout: 5

  # Configuration file paths (on Asterisk server or shared Docker volume)
  pjsip_config_path: "/etc/asterisk/pjsip.conf"
  extensions_config_path: "/etc/asterisk/extensions.conf"

  # PJSIP generation settings
  context: "from-internal"  # Default dialplan context for endpoints
  transport: "transport-udp"  # PJSIP transport name

  # Error handling behavior
  fail_on_ami_error: false  # If true, rollback phone CRUD on AMI failure
  retry_on_failure: true
  retry_max_attempts: 3
  retry_delay_seconds: 5
